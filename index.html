<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GMod Verification</title>
<style>
    html, body {
        margin:0; padding:0;
        height:100%;
        font-family: Arial, sans-serif;
        overflow:hidden;
        background:#111;
        color:#fff;
    }
    body {
        display:flex;
        justify-content:center;
        align-items:center;
        flex-direction:column;
        background: linear-gradient(45deg, #111 25%, #eee 25%, #eee 50%, #111 50%, #111 75%, #eee 75%, #eee 100%);
        background-size: 100px 100px;
        animation: bgAnim 10s linear infinite;
    }
    @keyframes bgAnim {
        0% {background-position:0 0;}
        100% {background-position:200px 200px;}
    }
    #container { text-align:center; }
    #progressText { font-size:24px; margin-bottom:10px; }
    #verifyBtn {
        padding: 15px 40px;
        font-size: 20px;
        background: #fff;
        border: none;
        cursor:pointer;
        transition: 0.3s;
        color:#000;
    }
    #verifyBtn:hover:not([disabled]) { background:#ff0; }
    #verifyBtn:disabled { background:#555; cursor:not-allowed; }
    #steamSection { margin-top:20px; display:none; }
    #steamInput { padding:8px; font-size:16px; width:300px; }
</style>
</head>
<body>
<div id="container">
    <div id="progressText">1/3</div>
    <button id="verifyBtn">Verify</button>

    <div id="steamSection">
        <input type="text" id="steamInput" placeholder="Enter SteamID64">
        <button id="finalBtn" disabled>Verify SteamID</button>
        <div id="steamInfo"></div>
    </div>
</div>

<script>
const LINKVERTISE_URL = "https://link-hub.net/885733/wzN3sZmiiPCM";
let progress = 0;
let timerDone = false;
let timerStart = null;

const verifyBtn = document.getElementById("verifyBtn");
const progressText = document.getElementById("progressText");
const steamSection = document.getElementById("steamSection");
const steamInput = document.getElementById("steamInput");
const finalBtn = document.getElementById("finalBtn");
const steamInfo = document.getElementById("steamInfo");

// On page load, check if ?verify is present
if(window.location.search.includes("verify") && localStorage.getItem("timerStart")) {
    const elapsed = Date.now() - parseInt(localStorage.getItem("timerStart"));
    if(elapsed >= 20000) { // 20s
        timerDone = true;
        progress++;
        progressText.textContent = progress + "/3";
        verifyBtn.disabled = false;
        localStorage.removeItem("timerStart");
        if(progress>=3) showSteamInput();
    } else {
        verifyBtn.disabled = true;
        const remaining = 20000 - elapsed;
        setTimeout(() => { 
            timerDone = true; 
            progress++; 
            progressText.textContent = progress + "/3"; 
            verifyBtn.disabled = false;
            if(progress>=3) showSteamInput();
        }, remaining);
    }
}

// Click handler
verifyBtn.addEventListener("click", () => {
    if(progress < 3) {
        // Start 20s timer
        localStorage.setItem("timerStart", Date.now());
        window.open(LINKVERTISE_URL, "_blank");
        verifyBtn.disabled = true;
        setTimeout(() => {
            timerDone = true;
            progress++;
            progressText.textContent = progress + "/3";
            verifyBtn.disabled = false;
            if(progress>=3) showSteamInput();
        }, 20000);
    }
});

function showSteamInput() {
    progressText.textContent = "Completed!";
    verifyBtn.style.display = "none";
    steamSection.style.display = "block";
}

// SteamID input logic
steamInput.addEventListener("input", () => {
    if(steamInput.value.trim().length>5) {
        finalBtn.disabled = false;
    } else {
        finalBtn.disabled = true;
    }
});

// Fake SteamID profile check (replace with API if needed)
finalBtn.addEventListener("click", () => {
    const steamid = steamInput.value.trim();
    steamInfo.textContent = `SteamID: ${steamid}\nProfile Found!`;
    finalBtn.textContent = "Continue";
    finalBtn.disabled = false;

    // Final verification button
    finalBtn.addEventListener("click", () => {
        fetch("https://linkvertise-verifier.linkvertise-verifier-gmod.workers.dev/api/verify", {
            method: "POST",
            headers: { "Content-Type":"application/json" },
            body: JSON.stringify({ steamid })
        })
        .then(res => res.json())
        .then(data => {
            if(data.ok) alert("✅ Verified! You can now access the GMod script.");
            else alert("❌ Verification failed.");
        })
        .catch(err => alert("⚠️ Verification request failed!"));
    }, {once:true});
});
</script>
</body>
</html>
