<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GMod Modding Key System</title>
<style>
  body { font-family: Arial, sans-serif; background:#121212; color:#f0f0f0; text-align:center; margin-top:60px; }
  .card { background:#1e1e1e; border-radius:12px; padding:20px; width:320px; margin:auto; box-shadow:0 0 10px #0008; }
  input,button { width:90%; padding:10px; margin:8px; border-radius:6px; border:none; }
  input { background:#2a2a2a; color:#fff; }
  button { background:#007bff; color:#fff; cursor:pointer; }
  button:hover { background:#005ec9; }
</style>
</head>
<body>
  <div class="card" id="auth">
    <h2>Login / Signup</h2>
    <input id="username" placeholder="Username" />
    <input id="password" type="password" placeholder="Password" />
    <button onclick="signup()">Signup</button>
    <button onclick="login()">Login</button>
    <p style="font-size:12px;color:#aaa;">Username is unique and permanent.</p>
  </div>

  <div class="card" id="panel" style="display:none;">
    <h2 id="welcome"></h2>
    <input id="steamid" placeholder="e.g. STEAM_1:1:775200446" />
    <button onclick="generateKey()">Generate / Update Key</button>
    <p><strong>Generated Key:</strong> <span id="keyDisplay">None</span></p>
    <button onclick="logout()">Logout</button>
  </div>

<script>
  let currentUser = null;
  const users = JSON.parse(localStorage.getItem("users") || "{}");

  function signup(){
    const u = document.getElementById("username").value.trim();
    const p = document.getElementById("password").value.trim();
    if(!u || !p) return alert("Fill all fields.");
    if(users[u]) return alert("Username already exists.");
    users[u] = { password:p, steamid:"", generated_key:"" };
    localStorage.setItem("users",JSON.stringify(users));
    alert("Signup complete! Now login.");
  }

  function login(){
    const u = document.getElementById("username").value.trim();
    const p = document.getElementById("password").value.trim();
    if(!users[u]) return alert("No such user.");
    if(users[u].password!==p) return alert("Wrong password.");
    currentUser = u;
    document.getElementById("auth").style.display="none";
    document.getElementById("panel").style.display="block";
    document.getElementById("welcome").innerText="Welcome, "+u;
    document.getElementById("steamid").value=users[u].steamid;
    document.getElementById("keyDisplay").innerText=users[u].generated_key||"None";
  }

  function generateKey(){
    if(!currentUser) return;
    const s=document.getElementById("steamid").value.trim();
    if(!s) return alert("Enter your SteamID.");
    const key=Math.random().toString(36).substring(2,10).toUpperCase();
    users[currentUser].steamid=s;
    users[currentUser].generated_key=key;
    localStorage.setItem("users",JSON.stringify(users));
    document.getElementById("keyDisplay").innerText=key;
    alert("Key generated!");
  }

  function logout(){
    currentUser=null;
    document.getElementById("panel").style.display="none";
    document.getElementById("auth").style.display="block";
  }
</script>
</body>
</html>
