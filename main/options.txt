-- ESP Folder
local ESP = CreateFolder("ESP")
ESP:Option("Player ESP", true, function(val)
    if val then
        hook.Add("HUDPaint","PlayerESP",function()
            for _,ply in ipairs(player.GetAll()) do
                if ply==LocalPlayer() then continue end
                local headPos = ply:EyePos():ToScreen()
                draw.SimpleText(ply:Nick().." | HP:"..ply:Health(),"DermaDefault",headPos.x,headPos.y-10,Color(255,255,0),TEXT_ALIGN_CENTER)
            end
        end)
    else
        hook.Remove("HUDPaint","PlayerESP")
    end
end)

ESP:Option("Prop ESP", true, function(val)
    if val then
        hook.Add("HUDPaint","PropESP",function()
            for _,ent in ipairs(ents.GetAll()) do
                if not ent:IsPlayer() then
                    local scr = ent:LocalToWorld(ent:OBBCenter()):ToScreen()
                    draw.SimpleText(ent:GetClass(),"DermaDefault",scr.x,scr.y,Color(0,150,255),TEXT_ALIGN_CENTER)
                end
            end
        end)
    else
        hook.Remove("HUDPaint","PropESP")
    end
end)

ESP:Option("Enable Filter", false)
ESP:Option("prop_physics", true)
ESP:Option("prop_ragdoll", true)

-- Spectate Folder
local Spectate = CreateFolder("Spectate")
Spectate:Option("Enable Spectate", false, function(val)
    if val then
        hook.Add("CalcView","SpectateView",function(ply,pos,ang,fov)
            local target = player.GetAll()[2] -- just example, second player
            if IsValid(target) then
                local view = {}
                local headPos = target:EyePos()
                view.origin = headPos - target:GetForward()*100 + Vector(0,0,50)
                view.angles = (headPos - view.origin):Angle()
                view.fov = fov
                view.drawviewer = true
                return view
            end
        end)
    else
        hook.Remove("CalcView","SpectateView")
    end
end)
